This is the utility function for version 2
